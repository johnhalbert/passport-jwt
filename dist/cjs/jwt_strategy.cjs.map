{"version":3,"file":"jwt_strategy.cjs","mappings":"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","names":["tslib_1","extOptions","verify","_super","_this","options","secretOrKeyProvider","secretOrKeyProviderTimeout","secretOrKeyProviderTimeoutSeconds","_a","driver","jwtDriver","passReqToCallback","jwtFromRequest","TypeError","error_messages_1","NO_DRIVER_PROVIDED","validate","INVALID_DRIVER","secretOrKey","DRIVER_PROVIDES_KEY","BOTH_KEY_AND_PROVIDER","request","rawJwtToken","done","constructor","jsonWebTokenOptions","issuer","audience","LEGACY_OPTIONS_PASSED","NO_SECRET_KEY","NO_VERIFY_CALLBACK","NO_EXTRACTOR_FOUND","JwtStrategy","err","user","infoOrMessage","Error","error","success","USER_TRUE_WITH_MESSAGE","message","fail","USER_NOT_TRUTHY","secretOrKeyError","token","req","timeout","clearTimeout","NO_KEY_FROM_PROVIDER","then","result","NO_DRIVER_FAILURE_INFO","payload","callbackGenerator","ex","tokenOrPromise","undefined","Promise","resolve","NO_TOKEN","NO_TOKEN_ASYNC","setTimeout","PROVIDER_TIME_OUT","provided","key","processTokenInternal","catch","NO_PROMISE_RETURNED","passport_1","exports"],"sourceRoot":"","sources":["../../lib/jwt_strategy.ts"],"sourcesContent":[null]}