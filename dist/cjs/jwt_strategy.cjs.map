{"version":3,"file":"jwt_strategy.cjs","mappings":"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","names":["tslib_1","extOptions","verify","_super","_this","options","secretOrKeyProvider","checkIfProviderWorksTimeout","_a","driver","jwtDriver","TypeError","error_messages_1","NO_DRIVER_PROVIDED","validate","INVALID_DRIVER","secretOrKey","DRIVER_PROVIDES_KEY","BOTH_KEY_AND_PROVIDER","request","rawJwtToken","done","constructor","jsonWebTokenOptions","issuer","audience","LEGACY_OPTIONS_PASSED","NO_SECRET_KEY","NO_VERIFY_CALLBACK","jwtFromRequest","NO_EXTRACTOR_FOUND","passReqToCallback","JwtStrategy","err","user","infoOrMessage","Error","error","success","USER_TURE_WITH_MESSAGE","message","fail","USER_NOT_TRUE","secretOrKeyError","token","req","timeout","clearTimeout","NO_KEY_FROM_PROVIDER","then","result","NO_DRIVER_FAILURE_INFO","payload","verifiedInternal","ex","tokenOrPromise","undefined","Promise","resolve","NO_TOKEN","NO_TOKEN_ASYNC","setTimeout","PROVIDER_TIME_OUT","provided","key","processTokenInternal","catch","NO_PROMISE_RETURNED","passport_1","exports"],"sourceRoot":"","sources":["../../lib/jwt_strategy.ts"],"sourcesContent":[null]}